<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T21U3">pMC</span>] = permMC(<span class="var type1" id="S3T1U6">fCS</span>,<span class="var type1" id="S4T2U7">delta</span>,<span class="var type1" id="S5T5U8">sigma</span>,<span class="var type1" id="S6T4U9">start</span>,<span class="var type1" id="S7T3U10">numperms</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">3</a></span><span class="line"><span class="mxinfo" id="T21:U7"><span class="var type1" id="S2T21U13">pMC</span> = <span class="mxinfo" id="T21:U9">complex(<span class="mxinfo" id="T22:U10">zeros(<span class="mxinfo" id="T5:U11">size(<span class="var type1" id="S3T1U20">fCS</span>,1)</span>,<span class="mxinfo" id="T5:U13">size(<span class="var type1" id="S4T2U24">delta</span>,2)</span>,<span class="var type1" id="S7T3U26">numperms</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">5</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T3U29">p</span> = <span class="mxinfo" id="T3:U17">1</span>:<span class="var type1" id="S7T3U32">numperms</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">6</a></span><span class="line">    <span class="mxinfo" id="T1:U19"><span class="mxinfo" id="T1:U20"><span class="var type1" id="S2T21U36">pMC</span>(:,:,<span class="var type1" id="S11T3U39">p</span>)</span> = <span class="mxinfo" id="T1:U23"><span class="mxinfo" id="T1:U24"><span class="mxinfo" id="T1:U25">[<span class="mxinfo" id="T1:U26"><span class="var type1" id="S3T1U45">fCS</span>(:,<span class="mxinfo" id="T6:U28"><span class="mxinfo" id="T3:U29"><span class="var type1" id="S6T4U49">start</span>(<span class="var type1" id="S11T3U50">p</span>)</span>:<span class="mxinfo" id="T5:U32">end</span></span>)</span> <span class="mxinfo" id="T1:U33"><span class="var type1" id="S3T1U54">fCS</span>(:,<span class="mxinfo" id="T6:U35"><span class="mxinfo" id="T3:U36">1</span>:<span class="mxinfo" id="T3:U37"><span class="mxinfo" id="T3:U38"><span class="var type1" id="S6T4U60">start</span>(<span class="var type1" id="S11T3U61">p</span>)</span>-<span class="mxinfo" id="T5:U41">1</span></span></span>)</span>]</span>*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">7</a></span><span class="line"><span class="mxinfo" id="T1:U19"><span class="mxinfo" id="T1:U23"><span class="mxinfo" id="T1:U24">        <span class="mxinfo" id="T2:U42">exp(<span class="mxinfo" id="T2:U43"><span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T5:U46">-0.5</span>*<span class="var type1" id="S4T2U70">delta</span></span>.*<span class="var type1" id="S4T2U71">delta</span></span>/<span class="mxinfo" id="T5:U49"><span class="var type1" id="S5T5U73">sigma</span>^2</span></span>)</span></span>./(<span class="mxinfo" id="T2:U51"><span class="mxinfo" id="T2:U52">ones(<span class="mxinfo" id="T16:U53">size(<span class="var type1" id="S3T1U81">fCS</span>)</span>)</span>*<span class="mxinfo" id="T2:U55">exp(<span class="mxinfo" id="T2:U56"><span class="mxinfo" id="T2:U57"><span class="mxinfo" id="T2:U58"><span class="mxinfo" id="T5:U59">-0.5</span>*<span class="var type1" id="S4T2U89">delta</span></span>.*<span class="var type1" id="S4T2U90">delta</span></span>/<span class="mxinfo" id="T5:U62"><span class="var type1" id="S5T5U92">sigma</span>^2</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">8</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
