function [cf]=cwtDT(img,lev)
%function [cf]=cwtDT(img,lev)
%
% Compute the coefficients of complex wavelet transform by 
% Dual Tree algorithm. Using Anotonini Biorthogonal wavelet
% and qshift_c = 16,16 tap filters. 
% If no output arguments are specified, it will extract the 
% sub-images and display the CWT coefficients.
%
% INPUT:
%  [img] = 2-D array of pixel values.
%  [lev] = # of scale level of wavelet decomposition.
% OUTPUT:
%   [cf] = cell array of structures for CWT coeffients at
%          15, 45, 75, -15, -45 & -75 degrees. cell array
%          index correspond to scale levels. Hihgest cell
%          array index = low pass filter level.
%
% SEE ALSO: cwtInv, cwtQcf2str, cwtShowStr, cwtStr2mat
%
% By Michael Wu  --  waftingpetal@yahoo.com (Mar 2007)
%
% ====================


% Init Antonini & qShiftC filters
%--------------------
antonini.g0o=[-0.0456358815571251;  -0.0287717631142493;    0.295635881557128; ...
               0.557543526228502;    0.295635881557123;    -0.0287717631142531; ...
              -0.0456358815571261];
antonini.g1o=[ 0.0267487574108101;   0.0168641184428747;   -0.0782232665289905; ...
              -0.266864118442873;    0.602949018236359;    -0.266864118442877; ...
              -0.0782232665289884;   0.0168641184428753;    0.0267487574108096];
antonini.h0o=[ 0.0267487574108101;  -0.0168641184428747;   -0.0782232665289905; ...
               0.266864118442873;    0.602949018236359;     0.266864118442877; ...
              -0.0782232665289884;  -0.0168641184428753;    0.0267487574108096];
antonini.h1o=[ 0.0456358815571251;  -0.0287717631142493;   -0.295635881557128; ...
               0.557543526228502;   -0.295635881557123;    -0.0287717631142531; ...
               0.0456358815571261];
qshift_c.g0a=[ 0.00243034994514868; -0.000227652205897772; -0.00720267787825835; ...
               0.0184986827241562;   0.0222892632669227;   -0.112558884257522; ...
               0.0146374059644733;   0.567134484100133;     0.756393765199037; ...
               0.276368643133032;   -0.115911457427441;    -0.037273895799898; ...
               0.0349146123068422;  -7.14419732796501e-05; -0.000446022789262285; ...
              -0.00476161193845591];
qshift_c.g0b=[-0.00476161193845591; -0.000446022789262285; -7.14419732796501e-05; ...
               0.0349146123068422;  -0.037273895799898;    -0.115911457427441; ...
               0.276368643133032;    0.756393765199037;     0.567134484100133; ...
               0.0146374059644733;  -0.112558884257522;     0.0222892632669227; ...
               0.0184986827241562;  -0.00720267787825835;  -0.000227652205897772; ...
               0.00243034994514868];
qshift_c.g1a=[ 0.00476161193845591; -0.000446022789262285;  7.14419732796501e-05; ...
               0.0349146123068422;   0.037273895799898;    -0.115911457427441; ...
              -0.276368643133032;    0.756393765199037;    -0.567134484100133; ...
               0.0146374059644733;   0.112558884257522;     0.0222892632669227; ...
              -0.0184986827241562;  -0.00720267787825835;   0.000227652205897772; ...
               0.00243034994514868];
qshift_c.g1b=[ 0.00243034994514868;  0.000227652205897772; -0.00720267787825835; ...
              -0.0184986827241562;   0.0222892632669227;    0.112558884257522; ...
               0.0146374059644733;  -0.567134484100133;     0.756393765199037; ...
              -0.276368643133032;   -0.115911457427441;     0.037273895799898; ...
               0.0349146123068422;   7.14419732796501e-05; -0.000446022789262285; ...
               0.00476161193845591];
qshift_c.h0a=[-0.00476161193845591; -0.000446022789262285; -7.14419732796501e-05; ...
               0.0349146123068422;  -0.037273895799898;    -0.115911457427441; ...
               0.276368643133032;    0.756393765199037;     0.567134484100133; ...
               0.0146374059644733;  -0.112558884257522;     0.0222892632669227; ...
               0.0184986827241562;  -0.00720267787825835;  -0.000227652205897772; ...
               0.00243034994514868];
qshift_c.h0b=[ 0.00243034994514868; -0.000227652205897772; -0.00720267787825835; ...
               0.0184986827241562;   0.0222892632669227;   -0.112558884257522; ...
               0.0146374059644733;   0.567134484100133;     0.756393765199037; ...
               0.276368643133032;   -0.115911457427441;    -0.037273895799898; ...
               0.0349146123068422;  -7.14419732796501e-05; -0.000446022789262285; ...
              -0.00476161193845591];
qshift_c.h1a=[ 0.00243034994514868;  0.000227652205897772; -0.00720267787825835; ...
              -0.0184986827241562;   0.0222892632669227;    0.112558884257522; ...
               0.0146374059644733;  -0.567134484100133;     0.756393765199037; ...
              -0.276368643133032;   -0.115911457427441;     0.037273895799898; ...
               0.0349146123068422;   7.14419732796501e-05; -0.000446022789262285; ...
               0.00476161193845591];
qshift_c.h1b=[ 0.00476161193845591; -0.000446022789262285;  7.14419732796501e-05; ...
               0.0349146123068422;   0.037273895799898;    -0.115911457427441; ...
              -0.276368643133032;    0.756393765199037;    -0.567134484100133; ...
               0.0146374059644733;   0.112558884257522;     0.0222892632669227; ...
              -0.0184986827241562;  -0.00720267787825835;   0.000227652205897772; ...
               0.00243034994514868];

% Perform CWT
%--------------------
[cwtc.coef,cwtc.siz]=dtwavedec2mw(img,lev,antonini,qshift_c);


% Convert to Subimage coeff structure
%--------------------
cf=cwtQcf2str(cwtc);


% Display CWT coefficients
%--------------------
if nargout<1
  cwtShowStr(cf);
end


